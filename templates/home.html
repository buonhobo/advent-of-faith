<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8"/>
    <title>Advent of Faith | Home</title>
    <meta content="width=device-width, initial-scale=1" name="viewport"/>

    <link
            crossorigin="anonymous"
            href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
            integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
            rel="stylesheet"
    />

    <link href="https://fonts.googleapis.com" rel="preconnect">
    <link crossorigin href="https://fonts.gstatic.com" rel="preconnect">
    <link
            href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,600&family=Inter:wght@400;600&display=swap"
            rel="stylesheet"
    >

    <link href="/static/css/theme.css" rel="stylesheet">
</head>

<body>
<div class="wrap">
    <main class="container-fluid px-3 py-5">
        <div class="main-content">
            <h1 class="title text-center mb-5">Here are your calendars, {{ user.username }}</h1>

            {% if user_calendars.is_empty() %}
            <div class="no-calendars">
                <p>You have no calendars yet.<br>
                    Create one or subscribe to an existing one!</p>
            </div>
            {% else %}
            {% for rich_cal in user_calendars %}
            <div class="calendar-card">
                <a class="calendar-header text-decoration-none" href="/calendar/{{ rich_cal.calendar.calendar.id }}">
                    <div>
                        <div class="calendar-title">{{ rich_cal.calendar.calendar.title }}</div>
                        {% if rich_cal.calendar.calendar.owner_id == user.id %}
                        <div class="calendar-meta">Created on {{ rich_cal.calendar.calendar.created_at.format("%b %d,
                            %Y") }}
                        </div>
                        {% else %}
                        <div class="calendar-meta">Subscribed on {{ rich_cal.calendar.subscribed_at.unwrap().format("%b
                            %d, %Y") }}
                        </div>
                        {% endif %}
                    </div>
                </a>

                {% if rich_cal.days.is_empty() %}
                <p class="no-days">This calendar has no days yet.</p>
                {% else %}
                <div class="days-row-wrapper">
                    <div class="days-row">
                        {% for user_day in rich_cal.days %}
                        {% set status = user_day.get_status() %}
                        {% if status.as_str() == "future" %}
                        <div class="day-card day-future">
                            <div class="day-number">{{ user_day.day.unlocks_at.format("%d") }}</div>
                            <div class="day-label">{{ user_day.day.unlocks_at.format("%b %Y") }}</div>
                        </div>
                        {% elif status.as_str() == "locked" %}
                        <a class="day-card day-locked"
                           href="/calendar/{{ rich_cal.calendar.calendar.id }}/day/{{ user_day.day.id }}">
                            <div class="day-number">{{ user_day.day.unlocks_at.format("%d") }}</div>
                            <div class="day-label">{{ user_day.day.unlocks_at.format("%b %Y") }}</div>
                        </a>
                        {% else %}
                        <a class="day-card day-unlocked"
                           href="/calendar/{{ rich_cal.calendar.calendar.id }}/day/{{ user_day.day.id }}">
                            <div class="day-number">{{ user_day.day.unlocks_at.format("%d") }}</div>
                            <div class="day-label">{{ user_day.unlocked_at.unwrap().format("%b %Y") }}</div>
                        </a>
                        {% endif %}
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
            {% endfor %}
            {% endif %}

            <a class="create-calendar-link" href="/calendar/create">ï¼‹ Create New Calendar</a>
        </div>
    </main>

    <div class="text-center mt-2">
        <small class="footer-note">
            Logged in as <span class="user-highlight">{{ user.username }}</span>.
            <a class="link-underline link-underline-opacity-0" href="/" style="color:#ffd9b3;">Go back</a>
        </small>
    </div>
    <footer class="container-fluid text-center pb-4">
        <small class="footer-note">Made with ðŸ’› by Alex</small>
    </footer>
</div>

<script
        crossorigin="anonymous"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js">
</script>
</body>
</html>
